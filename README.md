A sample web application server vulnerable to [tokage](https://github.com/cubsphere/tokage).

## Scenario

An attacker with a standard user account seeks to take control of a target victim's account. The application has a "forgot my password" functionality that sends a secret 2FA code to a user's email. This code is generated by `System.Random` and the application runs on .NET Framework or .NET Standard, so this mechanism is vulnerable to a prediction attack by tokage.

### Attacker account

```
email: "attacker@evil.com"
username: "evil"
uassword: "123123"
```

### Victim account

```
email: "target@victim.moe"
username: "target"
password: an unknown, randomly generated string
```

Additionally, a set of attacker tools are available on the "forgot my password" webpage. They help generate the timestamps and number list required for tokage.

## Execution

Download this repo and build/run it in any .NET IDE and it should work.

### Arguments

```
-h, --help                 show this message and exit
-m, --mean=VALUE           mean network delay
-d, --std=VALUE            network delay standard deviation
-f, --force                force Environment.TickCount as seed
-s, --single               use single instance instead of new Random().Next()
-n, --newthread            use a new thread for each request (default is single-thread)
```